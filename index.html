<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- CSS -->
    <link rel="stylesheet" href="css/bootstrap-reboot.min.css">
    <link rel="stylesheet" href="css/bootstrap-grid.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/select2.min.css">
    <link rel="stylesheet" href="css/main.css">

    <!-- Favicons -->
    <link rel="icon" type="image/png" href="icon/vlogo.PNG" sizes="32x32">
    <link rel="apple-touch-icon" href="icon/vlogo.PNG">

    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="Dmitry Volkov">
    <title>CE VIRTUAL CHURCH</title>

</head>

<body>
    <!-- header -->
    <header class="header">
        <div class="header__content">
            <div class="header__logo">
                <a>
                    <img src="img/vlogo.PNG" alt="">
                </a>
            </div>


            <div class="header__menu">
                <ul class="header__nav">
                    <li class="header__nav-item">
                        <a class="header__nav-link" href="#" role="button" id="dropdownMenuHome" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Home </a>

                        <li class="header__nav-item">
                            <a href="about.html" class="header__nav-link">About Us</a>
                        </li>


                        <li class="header__nav-item">
                            <a href="contact.html" class="header__nav-link">Contact Us</a>
                        </li>

                </ul>
            </div>

            <div class="header__actions">


                <div class="header__action header__action--profile">
                    <a class="header__profile-btn " href="#" role="button" id="dropdownMenuProfile" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">

                        <div>
                            <p>Admin Login</p>
                        </div>
                        <svg xmlns="" viewBox="0 0 24 24"><path d="M17,9.17a1,1,0,0,0-1.41,0L12,12.71,8.46,9.17a1,1,0,0,0-1.41,0,1,1,0,0,0,0,1.42l4.24,4.24a1,1,0,0,0,1.42,0L17,10.59A1,1,0,0,0,17,9.17Z"></path></svg>
                    </a>

                    <ul class="dropdown-menu header__profile-menu" aria-labelledby="dropdownMenuProfile">


                        <li>
                            <a href="https://adm.cevirtualchurch.org/admin-login" target="_blank"><span>Login</span></a>
                        </li>
                    </ul>
                </div>
            </div>

            <button class="header__btn" type="button">
				<span></span>
				<span></span>
				<span></span>
			</button>
        </div>
    </header>
    <!-- end header -->

    <!-- main content -->
    <main class="main">
        <div class="container">
            <div class="row row--grid">
                <!-- breadcrumb -->

                <!-- end breadcrumb -->

                <!-- title -->
                <div class="col-12">
                    <div class="main__title main__title--page">
                        <h1>Live Event</h1>
                    </div>
                </div>
                <!-- end title -->
            </div>

            <div class="row">
                <!-- content -->
                <div class="col-12 col-xl-8">
                    <div class="row" id="multi-video-div">


                        <div class="col-md-9 col-md-offset-3" id="multi-video">
                            <div align="center">
                                <i class="fa fa-spinner fa-spin"></i>

                            </div>



                        </div>
                    </div>
                </div>
                <!-- end content -->

                <!-- sidebar -->
                <div class="col-12 col-xl-4">
                    <div class="asset__info">
                        <div class="asset__desc">
                            <h2>Partner With Us Today</h2>
                            <p>New Media Technologies is an arm of the ministry of the man of God Pastor Chris poised at using revolutionary media technologies in the spread of the gospel of our Lord Jesus Christ around the world Join us in reaching and
                                impacting many around the world through the Virtual Church Platform & Hosting Services Sponsorship..</p>
                        </div>



                        <!-- tabs -->
                        <ul class="nav nav-tabs asset__tabs" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" data-toggle="tab" href="#tab-1" role="tab" aria-controls="tab-1" aria-selected="true">See Translations</a>
                            </li>

                        </ul>

                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="tab-1" role="tabpanel">
                                <div class="asset__actions asset__actions--scroll" id="asset__actions--scroll">
                                    <div class="">
                                        <a id="trans_view" href=""></a>

                                    </div>
                                    <p>
                                        <a id="trans_view" href="#">
                                        </a>
                                    </p>

                                </div>
                            </div>



                            <!-- <div class="tab-pane fade" id="tab-3" role="tabpanel">
                                <ul class="asset__authors asset__authors--tab">
                                    <li>
                                        <span>Owner</span>
                                        <div class="asset__author asset__author--verified">
                                            <img src="img/avatars/avatar5.jpg" alt="">
                                            <a href="author.html">@midinh</a>
                                        </div>
                                    </li>
                                    <li>
                                        <span>Year created</span>
                                        <p>2021</p>
                                    </li>
                                </ul>
                            </div> -->
                        </div>
                        <!-- end tabs -->

                        <!-- <div class="asset__wrap">
                            <div class="asset__timer">
                                <span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.3,8.59l.91-.9a1,1,0,0,0-1.42-1.42l-.9.91a8,8,0,0,0-9.79,0l-.91-.92A1,1,0,0,0,4.77,7.69l.92.91A7.92,7.92,0,0,0,4,13.5,8,8,0,1,0,18.3,8.59ZM12,19.5a6,6,0,1,1,6-6A6,6,0,0,1,12,19.5Zm-2-15h4a1,1,0,0,0,0-2H10a1,1,0,0,0,0,2Zm3,6a1,1,0,0,0-2,0v1.89a1.5,1.5,0,1,0,2,0Z"/></svg> Auction ends in</span>
                                <div class="asset__clock"></div>
                            </div>

                            <div class="asset__price">
                                <img src="img/blockchain/3.png" alt="">
                                <p>Minimum bid</p>
                                <span>0.2 ETH</span>
                            </div>
                        </div> -->

                        <!-- actions -->
                        <div class="asset__btns">
                            <a href="https://kingspayweb.com/quickpay/NMTP1" class="asset__btn asset__btn--full asset__btn--clr  ">Partner with us</a>
                        </div>
                        <!-- end actions -->
                    </div>
                </div>
                <!-- end sidebar -->
            </div>

            <!-- explore -->

            <!-- end explore -->
        </div>
    </main>
    <!-- end main content -->

    <!-- footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-sm-4 col-md-4 col-lg-6 col-xl-4 order-4 order-md-1 order-lg-4 order-xl-1">



                </div>

                <!-- <div class="col-6 col-md-4 col-lg-3 col-xl-2 order-1 order-md-2 order-lg-1 order-xl-2 offset-md-2 offset-lg-0">
                    <h6 class="footer__title">Join a Church</h6>

                </div> -->

                <div class="col-6 col-md-4 col-lg-4 col-xl-4 order-3 order-lg-2 order-md-3 order-xl-3">
                    <div class="row">
                        <div class="col-12">
                            <a href="#" onclick="logout()">
                                <h6 class="footer__title">Logout</h6>
                            </a>
                        </div>

                    </div>
                </div>

                <div class="col-6 col-md-4 col-lg-3 col-xl-2 order-2 order-lg-3 order-md-4 order-xl-4">
                    <a href="/change-church.html">
                        <h6 class="footer__title">Change Church</h6>
                    </a>




                </div>
            </div>

            <div class="row">
                <div class="col-12">
                    <div class="footer__content">


                        <small class="footer__copyright"><p class="copyright">&copy; 2023 Christ Embassy. All Rights Reserved ver 3.1.0</p></small>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- end footer -->

    <!-- modal bid -->

    <!-- end modal wallet -->

    <!-- JS -->
    <script src="js/jquery-3.6.0.min.js "></script>
    <script src="js/bootstrap.bundle.min.js "></script>
    <script src="js/owl.carousel.min.js "></script>
    <script src="js/jquery.magnific-popup.min.js "></script>
    <script src="js/select2.min.js "></script>
    <script src="js/smooth-scrollbar.js "></script>
    <script src="js/jquery.countdown.min.js "></script>
    <script src="js/three.min.js "></script>
    <script src="js/vanta.waves.min.js "></script>
    <script src="js/main.js "></script>





    <script>
        $(document).ready(function() {


            $(".change_stream ").click(function() {
                var new_url = $(this).attr("stream_url ")
                var stream_type = $(this).attr("stream_type ")

                var player = videojs("video-js ");
                player.src({
                    src: new_url,

                });

                player.load();
                player.play();

                $("#stream_type ").html(stream_type);


            });

            $("#btn ").on("click ", function() {
                $("#video ").html("<source src='" + $("#url").val() +
                    "' type='application/x-mpegURL'>");
                var ply = videojs("video");
                ply.play();
            });
        });
    </script>





    <script>
        serviceDetails();

        function serviceDetails() {


            $("meetingName").html("");
            // NProgress.start();

            var userData = JSON.parse(localStorage.getItem('authuser'));
            var offline = '<li><a href="/login">Login</a></li> <li><a href="/register">Sign Up</a></li><li><a ' +
                'class="theme-btn">Next Service</a></li>'

            var online = '<li class="theme-btn btn-info" style="background-color:#062265;"><a href="about.html" target="_blank" style=" padding: 7px 20px;margin-top: 9px; color:white;text-align: ' +
                'center">About us</a></li><li class="theme-btn btn-info" style="background-color:#062265;"><a href="partner.html" target="_blank" style=" padding: 7px 20px;margin-top: 9px; color:white;text-align: ' +
                'center">Partner</a></li><li class="theme-btn btn-info" style="background-color:#062265;"><a href="https://christembassy.org/contact/" target="_blank" style=" padding: 7px 20px;margin-top: 9px; color:white;text-align: ' +
                'center">Contact Us</a></li>' +
                ''
                //logout a user

            //check if a user is logged in or not
            if (userData != null && userData != "") {

                //  alert("i am logged in")
                $("#contact-infos").html(online)
            } else {
                window.location.href = "/login.html"
                    // $("#contact-info").html(offline)
            }


            //get church video data
            var church_id = userData.user.userDetails.churchID;
            var full_name = userData.user.userDetails.firstName + " " + userData.user.userDetails.lastName;
            var church_name = userData.user.userDetails.churchName;
            var email = userData.user.userDetails.emailAddress;

            $("#full_name").html(full_name);
            $(".church_name").html(church_name);


            var banners = '<div class="carousel-item active"><a href="trans_partner.html"><img class="d-block w-100" src="assets/trans_slider.jpeg" alt=""></a></div>';

            if (userData.user.churchDetails.banners.length > 0) {

                for (var i = 0; i < userData.user.churchDetails.banners.length; i++) {
                    if (i == 0) {
                        banners += `<div class="carousel-item">
                                          <img class="d-block w-100" src="${userData.user.churchDetails.banners[i].path}" alt="Third slide">
                                      </div>`
                    } else {
                        banners += `<div class="carousel-item">
                                          <img class="d-block w-100" src="${userData.user.churchDetails.banners[i].path}" alt="Third slide">
                                      </div>`
                    }



                }


            }



            $("#banner_slider").html(banners)



            var formData = {

                'churchID': church_id,
                'email': userData.user.userDetails.emailAddress,
            };

            $.ajax({
                type: 'POST', // define the type of HTTP verb we want to use (POST for our form)
                url: 'https://api.cevirtualchurch.org/services/multipleservices', // the url where we want to POST
                data: formData,
                dataType: 'json', // what type of data do we expect back from the server
                encode: true
            })

            //
            // using the done promise callback
            .done(function(data) {

                if (data.data.meetingDetails.length > 0) {

                    var obj = "";

                    for (var i = 0; i < data.data.meetingDetails.length; i++) {
                        obj += '<div class="col-md-4"><div style="margin-top:20px;border-line:2px;border-color: #fff;!important;background-color:#011b57;padding:10px;border-radius:7px;"> <a href="/video.html?meeting_id=' + data.data.meetingDetails[i].meetingID + '"><img style=" filter: brightness(0%);" src="/assets/images/members.png" alt=""><h4 style="color: #fff;!important"> ' + data.data.meetingDetails[i].meetingName + '</h4><p style="color: #fff;!important"> </p><div class="centered" align="center"><img style="max-width:40%;margin-bottom: 30%;" src="/assets/images/play-button.png" onclick=""  > </div></div></a></div>';
                    }


                    console.log("sisis")
                    console.log(obj)



                    $("#multi-video-div").html(obj);
                } else {

                    $("#multi-video-div").html('<div class="col-md-12 alert " align="center"><h2>No live event(s) at the moment</h2></div> <video controls autoplay style="width:100%;height:400px"><source src="https://psupport.s3.us-west-2.amazonaws.com/sept_imm_promo/sept_general_promo.mp4"></video>');
                }




                if (data.data.nextMeetingDetails != null) {

                    if (data.data.nextMeetingDetails.length != "") {

                        // alert("I am here")


                        $(document).ready(function() {
                            var clock;

                            clock = $('.clock').FlipClock({
                                clockFace: 'DailyCounter',
                                autoStart: false,
                                callbacks: {
                                    stop: function() {
                                        $.notify("Service starts now, please refresh this page", {
                                            className: 'success',
                                            autoHide: true,
                                        });

                                        serviceDetails();

                                    }
                                }
                            });

                            $("#meeting_title").html(data.data.nextMeetingDetails.meetingName)
                                // var clock;

                            var tts = Math.round(new Date().getTime() / 1000);

                            var schtime = data.data.nextMeetingDetails.startTime;


                            if (schtime > tts) {
                                var meeting_time = schtime - tts;
                            } else {
                                var meeting_time = 0;
                            }

                            clock.setTime(meeting_time);
                            clock.setCountdown(true);
                            clock.start();

                        });


                        $("#video-div").html('');
                        $("#clock-div").show(1000);

                    } else {


                        $("#multi-video").html("<div style='margin-top:100px' class='alert alert-info'>No Upcoming Event</div>");


                    }



                    //var meeting_time = schtime - tts;
                    //1587168000
                    // console.log(meeting_time);


                } else {
                    $("#video-div").html("<div style='margin-top:100px' class='alert alert-info'>No Active Service</div>");
                }




            })
        };
    </script>


    <script>
        //serviceDetails2();
        function serviceDetails2() {


            $("meetingName").html("");

            NProgress.start();

            var userData = JSON.parse(localStorage.getItem('authuser'));



            //logout a user




            //get church video data
            var church_id = userData.user.userDetails.churchID;
            var full_name = userData.user.userDetails.firstName + " " + userData.user.userDetails.lastName;
            var church_name = userData.user.userDetails.churchName;


            $("#full_name").html(full_name);
            $(".church_name").html(church_name);

            //        var formData = {
            //            'meetingID': meetingID,
            //        };


            var formData = {
                'churchID': church_id,
                'email': userData.user.userDetails.emailAddress,
            };


            $.ajax({
                type: 'POST', // define the type of HTTP verb we want to use (POST for our form)
                url: 'https://api.cevirtualchurch.org/services/live', // the url where we want to POST
                data: formData,
                dataType: 'json', // what type of data do we expect back from the server
                encode: true
            })

            //
            // using the done promise callback
            .done(function(data) {

                console.log(data);
                // alert("I dididid")
                // log data to the console so we can see
                // console.log("I got here too just now");

                const datar = data.data.paymentDetails;


                localStorage.setItem('paymentdetails', JSON.stringify(datar));


                //check for card payment

                //
                //
                if (!data.status) {



                    $("#upcoming-video").html('<div class="col-md-12 alert "><h2>No Live event(s) at the moment</h2></div>');


                    const datar = data.data.paymentDetails;


                    localStorage.setItem('paymentdetails', JSON.stringify(datar));

                    // console.log(data.data.meetingDetails.meetingName)



                    NProgress.done();


                } else {

                    NProgress.done();

                    if (data.data.nextMeetingDetails != null) {

                        if (data.data.nextMeetingDetails.length > 0) {


                            $(document).ready(function() {
                                var clock;

                                clock = $('.clock').FlipClock({
                                    clockFace: 'DailyCounter',
                                    autoStart: false,
                                    callbacks: {
                                        stop: function() {
                                            $.notify("Service starts now, please refresh this page", {
                                                className: 'success',
                                                autoHide: true,
                                            });

                                            serviceDetails();

                                        }
                                    }
                                });

                                clock.setTime(meeting_time);
                                clock.setCountdown(true);
                                clock.start();

                            });


                            $("#video-div").html('');
                            $("#clock-div").show(1000);

                        } else {


                            $("#multi-video").html("<div style='margin-top:100px' class='alert alert-info'>No Upcoming Event</div>");


                        }

                        $("#meeting_title").html(data.data.nextMeetingDetails.meetingName)
                        var clock;

                        var tts = Math.round(new Date().getTime() / 1000);

                        var schtime = data.data.nextMeetingDetails.startTime;


                        if (schtime > tts) {
                            var meeting_time = schtime - tts;
                        } else {
                            var meeting_time = 0;
                        }

                        //var meeting_time = schtime - tts;
                        //1587168000
                        // console.log(meeting_time);


                    } else {
                        $("#video-div").html("<div style='margin-top:100px' class='alert alert-info'>No Active Service</div>");
                    }


                }

                // here we will handle errors and validation messages
            });
        }
    </script>
    <script>
        var trans_arr = ['English', 'French', 'Hindi', 'Italian', 'Spanish', 'Slovak', 'Swahili', 'Hausa', 'German', 'Igbo', 'Portuguese']

        obj = '';

        for (var i = 0; i < trans_arr.length; i++) {
            obj += "<li class='user'> <a href='/trans_view.html?translation=" + trans_arr[i] + "'> " + trans_arr[i] + " </a></li> "
        }

        $("#trans_view").html(obj);
    </script>
    <script>
        function logout() {

            //alert("I was clcked");
            localStorage.removeItem('authuser');
            window.location.href = "/login.html";
        }
    </script>
</body>

</html>
</body>

</html>